package main

test_downloadRegCertificate {
    allow.allowed with input as {"attributes":{"request":{"http":{"headers":{"x-authenticated-user-token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImFjY2Vzc3YxX2tleTEifQ.eyJhdWQiOiJodHRwczovL3N1bmJpcmRlZC5vcmcvYXV0aC9yZWFsbXMvc3VuYmlyZCIsInN1YiI6ImY6NWJiNmM4N2MtN2M4OC00ZDJiLWFmN2UtNTM0YTJmZWY5NzhkOjI4YjBkMDhmLWMyZWEtNDBkMS1iY2QwLThhZTAwZmNhNjZiZSIsInJvbGVzIjpbeyJyb2xlIjoiQk9PS19DUkVBVE9SIiwic2NvcGUiOlt7Im9yZ2FuaXNhdGlvbklkIjoiMDEzNjk4Nzg3OTc1MDM2OTI4MTAifV19LHsicm9sZSI6IkNPTlRFTlRfQ1JFQVRPUiIsInNjb3BlIjpbeyJvcmdhbmlzYXRpb25JZCI6IjAxMzY5ODc4Nzk3NTAzNjkyODEwIn1dfSx7InJvbGUiOiJDT05URU5UX1JFVklFV0VSIiwic2NvcGUiOlt7Im9yZ2FuaXNhdGlvbklkIjoiMDEzNjk4Nzg3OTc1MDM2OTI4MTAifV19LHsicm9sZSI6IkNPVVJTRV9NRU5UT1IiLCJzY29wZSI6W3sib3JnYW5pc2F0aW9uSWQiOiIwMTM2OTg3ODc5NzUwMzY5MjgxMCJ9XX0seyJyb2xlIjoiUFJPR1JBTV9ERVNJR05FUiIsInNjb3BlIjpbeyJvcmdhbmlzYXRpb25JZCI6IjAxMzY5ODc4Nzk3NTAzNjkyODEwIn0seyJvcmdhbmlzYXRpb25JZCI6IjAxMzY5ODc4Nzk3NTAzNjkyODEwIn1dfSx7InJvbGUiOiJSRVBPUlRfVklFV0VSIiwic2NvcGUiOlt7Im9yZ2FuaXNhdGlvbklkIjoiMDEzNjk4Nzg3OTc1MDM2OTI4MTAifV19LHsicm9sZSI6IlBVQkxJQyIsInNjb3BlIjpbXX1dLCJpc3MiOiJodHRwczovL3N1bmJpcmRlZC5vcmcvYXV0aC9yZWFsbXMvc3VuYmlyZCIsIm5hbWUiOiJkZW1vIiwidHlwIjoiQmVhcmVyIiwiZXhwIjoxNjQwMjM2MTAyLCJpYXQiOjE2NDAxNDk3MDV9.qFA-yA18e3_gt9T_ixdigW_Doj__H9oJQjcL1NKLN-USWHgze5eBaY3TD5cnLr9fDEOH3oXlOuZ64Hzm0NRJTTQkVYD598hun9wAHzSDWlZWn2dVI62MVxzGntxcnq2z-p3VL0fIMv7Kd5YH6viVlygAyFlr047N5J1fPA5gMG3Z60jy8k3ome_Hmv8VCrf66QUW4g8SOUVwqIx1f9Vb4Qj2LWOu-n2b_H8RQ4Nqae8SE3aE3RcTLWIqRHOf1GKYoujxrlUW6z74kjJOjePy8TeehFd7thYCrSw2-TMdhNSpPivroF3zTEb0kOu1_ldKxV4wp4eViBlaqElEc-S_8g"},"path":"/certs/v1/registry/download"}}}} with data.common.federation_id as "5bb6c87c-7c88-4d2b-af7e-534a2fef978d"
}

test_downloadRegCertificateV2 {
    allow.allowed with input as {"attributes":{"request":{"http":{"headers":{"x-authenticated-user-token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6ImFjY2Vzc3YxX2tleTEifQ.eyJhdWQiOiJodHRwczovL3N1bmJpcmRlZC5vcmcvYXV0aC9yZWFsbXMvc3VuYmlyZCIsInN1YiI6ImY6NWJiNmM4N2MtN2M4OC00ZDJiLWFmN2UtNTM0YTJmZWY5NzhkOjI4YjBkMDhmLWMyZWEtNDBkMS1iY2QwLThhZTAwZmNhNjZiZSIsInJvbGVzIjpbeyJyb2xlIjoiQk9PS19DUkVBVE9SIiwic2NvcGUiOlt7Im9yZ2FuaXNhdGlvbklkIjoiMDEzNjk4Nzg3OTc1MDM2OTI4MTAifV19LHsicm9sZSI6IkNPTlRFTlRfQ1JFQVRPUiIsInNjb3BlIjpbeyJvcmdhbmlzYXRpb25JZCI6IjAxMzY5ODc4Nzk3NTAzNjkyODEwIn1dfSx7InJvbGUiOiJDT05URU5UX1JFVklFV0VSIiwic2NvcGUiOlt7Im9yZ2FuaXNhdGlvbklkIjoiMDEzNjk4Nzg3OTc1MDM2OTI4MTAifV19LHsicm9sZSI6IkNPVVJTRV9NRU5UT1IiLCJzY29wZSI6W3sib3JnYW5pc2F0aW9uSWQiOiIwMTM2OTg3ODc5NzUwMzY5MjgxMCJ9XX0seyJyb2xlIjoiUFJPR1JBTV9ERVNJR05FUiIsInNjb3BlIjpbeyJvcmdhbmlzYXRpb25JZCI6IjAxMzY5ODc4Nzk3NTAzNjkyODEwIn0seyJvcmdhbmlzYXRpb25JZCI6IjAxMzY5ODc4Nzk3NTAzNjkyODEwIn1dfSx7InJvbGUiOiJSRVBPUlRfVklFV0VSIiwic2NvcGUiOlt7Im9yZ2FuaXNhdGlvbklkIjoiMDEzNjk4Nzg3OTc1MDM2OTI4MTAifV19LHsicm9sZSI6IlBVQkxJQyIsInNjb3BlIjpbXX1dLCJpc3MiOiJodHRwczovL3N1bmJpcmRlZC5vcmcvYXV0aC9yZWFsbXMvc3VuYmlyZCIsIm5hbWUiOiJkZW1vIiwidHlwIjoiQmVhcmVyIiwiZXhwIjoxNjQwMjM2MTAyLCJpYXQiOjE2NDAxNDk3MDV9.qFA-yA18e3_gt9T_ixdigW_Doj__H9oJQjcL1NKLN-USWHgze5eBaY3TD5cnLr9fDEOH3oXlOuZ64Hzm0NRJTTQkVYD598hun9wAHzSDWlZWn2dVI62MVxzGntxcnq2z-p3VL0fIMv7Kd5YH6viVlygAyFlr047N5J1fPA5gMG3Z60jy8k3ome_Hmv8VCrf66QUW4g8SOUVwqIx1f9Vb4Qj2LWOu-n2b_H8RQ4Nqae8SE3aE3RcTLWIqRHOf1GKYoujxrlUW6z74kjJOjePy8TeehFd7thYCrSw2-TMdhNSpPivroF3zTEb0kOu1_ldKxV4wp4eViBlaqElEc-S_8g"},"path":"/certs/v2/registry/download"}}}} with data.common.federation_id as "5bb6c87c-7c88-4d2b-af7e-534a2fef978d"
}