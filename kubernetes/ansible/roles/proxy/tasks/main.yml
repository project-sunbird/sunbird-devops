---
# Proxy config
- name: Deleting domain ssl if present
  shell: kubectl get secrets ingress-cert -n istio-system && kubectl delete secrets ingress-cert -n istio-system
  ignore_errors: true

- name: Creating domain sssl
  shell: |
    cat {{ ssl_cert_file }} | kubectl apply - '
  no_log: true

- name: "Creating {{ item }}"
  shell: "kubectl apply -f {{ bootstrap_dir.path }}/{{ item }}.yaml"
  with_items:
    - gateway
    - serviceentry
    - virtualservice
