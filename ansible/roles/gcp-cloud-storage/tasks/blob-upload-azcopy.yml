---
- name: create container in azure storage if it doesn't exist
  include_role:
    name: azure-cloud-storage
    tasks_from: container-create.yml

- name: Upload a file to storage blob
  shell: "azcopy copy {{ local_file_path }} 'https://{{ storage_account_name }}.blob.core.windows.net/{{ blob_container_name }}{{ storage_account_sas_token }}' --recursive"
  environment:
    AZCOPY_CONCURRENT_FILES: "10"
  async: 10800
  poll: 10
