---
- name: Add default oci account name for backups
  become: yes
  shell: echo "{{ cloud_management_storage_accountname }}" | {{ es_home }}/bin/elasticsearch-keystore add -f s3.client.default.access_key
  no_log: True
  environment:
    ES_PATH_CONF: "{{ es_conf_dir }}"

- name: Add default oci account key for backups
  become: yes
  shell: echo "{{ cloud_management_storage_secret }}" | {{ es_home }}/bin/elasticsearch-keystore add -f s3.client.default.secret_key
  no_log: True
  environment:
    ES_PATH_CONF: "{{ es_conf_dir }}"


- name: Add default oci endpoint for backups
  become: yes
  shell: echo "{{ cloud_management_storage_endpoint }}" | {{ es_home }}/bin/elasticsearch-keystore add -f s3.client.default.endpoint
  no_log: True
  environment:
    ES_PATH_CONF: "{{ es_conf_dir }}"

- name: Add default oci region for backups
  become: yes
  shell: echo "{{ cloud_management_storage_region }}" | {{ es_home }}/bin/elasticsearch-keystore add -f s3.client.default.region
  no_log: True
  environment:
    ES_PATH_CONF: "{{ es_conf_dir }}"

- name: Add default path-style access for backups
  become: yes
  shell: echo "{{ cloud_management_storage_path_style_access }}" | {{ es_home }}/bin/elasticsearch-keystore add -f s3.client.default.path_style_access
  no_log: True
  environment:
    ES_PATH_CONF: "{{ es_conf_dir }}"   
