{"_id":{"$oid":"607e85d881f1d75d99c1c207"},"title":"NGINX_LOG_PARSE","description":"NGINX_LOG_PARSE","source":"rule \"NGINX_LOG_PARSE\"\nwhen contains(to_string($message.kubernetes_labels_app), \"nginx-public-ingress\", true)\nthen\nset_fields(grok(\"%{NGINX_LOG_PARSE}\", to_string($message.message), true));\nset_field(\"n_rstime\", to_double($message.n_rstime));\nset_field(\"n_rqtime\", to_double($message.n_rqtime));\nset_field(\"n_rssize\", to_long($message.n_rssize));\nset_field(\"n_rscode\", to_long($message.n_rscode));\nend","created_at":{"$date":"2021-04-20T07:42:16.804Z"},"modified_at":{"$date":"2021-04-20T07:45:47.125Z"}}
{"_id":{"$oid":"607e867881f1d75d99c1c2b6"},"title":"KONG_LOG_PARSE","description":"KONG_LOG_PARSE","source":"rule \"KONG_LOG_PARSE\"\nwhen contains(to_string($message.kubernetes_labels_app), \"apimanager\", true)\nthen\nset_fields(grok(\"%{KONG_LOG_PARSE}\", to_string($message.message), true));\nset_field(\"k_rscode\", to_long($message.k_rscode));\nset_field(\"k_rqsize\", to_long($message.k_rqsize));\nend","created_at":{"$date":"2021-04-20T07:44:56.058Z"},"modified_at":{"$date":"2021-04-20T07:44:56.058Z"}}
{"_id":{"$oid":"607e86f281f1d75d99c1c33d"},"title":"GEO_IP_LOOKUP","description":"GEO_IP_LOOKUP","source":"rule \"GEO_IP_LOOKUP\"\nwhen has_field(\"n_cip\")\nthen\nlet geo = lookup(\"geoip\", to_string($message.n_cip));\nset_field(\"n_cip_geolocation\", geo[\"coordinates\"]);\nset_field(\"n_cip_geo_country_code\", geo[\"country\"].iso_code);\nset_field(\"n_cip_geo_country_name\", geo[\"country\"].names.en);\nset_field(\"n_cip_geo_city_name\", geo[\"city\"].names.en);\nend","created_at":{"$date":"2021-04-20T07:46:58.642Z"},"modified_at":{"$date":"2021-04-22T08:08:02.359Z"}}
{"_id":{"$oid":"607e871981f1d75d99c1c369"},"title":"DRUID_ANAMOLY_PIPELINE","description":"DRUID_ANAMOLY_PIPELINE","source":"rule \"DRUID_ANAMOLY_PIPELINE\"\nwhen (contains(to_string($message.log_file_path), \"/home/analytics/anomaly_detection/data/anomaly_data.log\", true))\nthen\nlet json = parse_json(to_string($message.message));\nlet new_fields = select_jsonpath(json, { dimensions_id: \"$['dimensions'][0]['id']\", dimensions_value: \"$['dimensions'][0]['value']\"\n                                         metric_id: \"$['metric']['id']\", metric_value: \"$['metric']['value']\"});\nset_fields(new_fields);\nend","created_at":{"$date":"2021-04-20T07:47:37.720Z"},"modified_at":{"$date":"2021-05-27T12:27:49.530Z"}}
{"_id":{"$oid":"607e878e81f1d75d99c1c3ea"},"title":"DROP_ALL_DEBUG_INFO_SERVICE_HEALTH_LOGS","description":"DROP_ALL_DEBUG_INFO_SERVICE_HEALTH_LOGS","source":"rule \"DROP_ALL_DEBUG_INFO_SERVICE_HEALTH_LOGS\"\nwhen (\ncontains(to_string($message.message), \"DEBUG\", true)\nOR contains(to_string($message.message), \"INFO\", true)\nOR contains(to_string($message.message), \"/service/health\", true)\nOR contains(to_string($message.message), \"/health\", true)\nOR contains(to_string($message.message), \"/metrics\", true)\nOR contains(to_string($message.message), \"/status\", true)\n)\nthen\ndrop_message();\nend","created_at":{"$date":"2021-04-20T07:49:34.643Z"},"modified_at":{"$date":"2021-06-09T02:50:50.292Z"}}
{"_id":{"$oid":"607e882281f1d75d99c1c48f"},"title":"ROUTE_TO_SYSLOG_STREAM","description":"ROUTE_TO_SYSLOG_STREAM","source":"rule \"ROUTE_TO_SYSLOG_STREAM\"\nwhen (contains(to_string($message.log_file_path), \"/var/log/syslog\", true))\nthen\nroute_to_stream(name: \"syslog\", remove_from_default: true);\nend","created_at":{"$date":"2021-04-20T07:52:02.474Z"},"modified_at":{"$date":"2021-04-20T07:52:02.474Z"}}
{"_id":{"$oid":"607e885881f1d75d99c1c4cc"},"title":"ROUTE_ALL_NON_APPLICATION_NAMESPACE_TO_DIFFERENT_STREAM","description":"ROUTE_ALL_NON_APPLICATION_NAMESPACE_TO_DIFFERENT_STREAM","source":"rule \"ROUTE_ALL_NON_APPLICATION_NAMESPACE_TO_DIFFERENT_STREAM\"\nwhen (contains(to_string($message.kubernetes_namespace), \"monitoring\", true))\nOR (contains(to_string($message.kubernetes_namespace), \"logging\", true))\nOR (contains(to_string($message.kubernetes_namespace), \"kube-system\", true))\nthen\nroute_to_stream(name: \"Other Namespaces\", remove_from_default: true);\nend","created_at":{"$date":"2021-04-20T07:52:56.307Z"},"modified_at":{"$date":"2021-04-20T07:52:56.307Z"}}
{"_id":{"$oid":"607e918781f1d75d99c1cf01"},"title":"SET_TIME_TO_NOW","description":"SET_TIME_TO_NOW","source":"rule \"SET_TIME_TO_NOW\"\nwhen has_field(\"message\")\nthen\nset_field(\"timestamp\", now());\nend","created_at":{"$date":"2021-04-20T08:32:07.735Z"},"modified_at":{"$date":"2021-04-20T10:57:25.631Z"}}
