---
- name: copy the env.json file to the repo
  template:
    src: "{{item}}.j2"
    dest: "{{offline_repo_location}}/offline-installer-repo/src/{{item}}"
    mode: '0755'
  with_items:
    - env.json

- name: copy the Dockerfile file and build script for building offline installer
  template:
    src: "{{item}}.j2"
    dest: "{{offline_repo_location}}/offline-installer-repo/{{item}}"
    mode: '0755'
  with_items:
    - Dockerfile
    - build.sh

- name: create a directory to store artifacts
  file:
    path: "{{offline_repo_location}}/offline-installer-repo/offline_artifacts/{{build_number}}"
    state: directory
    recurse: yes

- name: upload to azure
  include: uploadToAzure.yml
  when: uploadInstaller is defined
