---
- hosts: processing-cluster-kafka, ingestion-cluster-kafka
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:
    - kafka 
                      
- hosts: zookeeper, ingestion-cluster-zookeeper
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:            
    - zookeeper

- hosts: keycloak
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:            
    - keycloak

- hosts: yarn
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:            
    - yarn

- hosts: es, composite-search-cluster, log-es
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:
    - es

- hosts: cassandra, dp-cassandra
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:            
    - cassandra
      
- hosts: learningall
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags: 
    - learning

- hosts: dial
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - dial

- hosts: learning-neo4j-cluster
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - neo4j

- hosts: lp-redis, dp-redis, lms-redis, redis-metadata
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - redis

- hosts: secor
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - secor

- hosts: spark
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - spark

- hosts: kafka-indexer
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - kafka-indexer

- hosts: influxdb
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - influxdb

- hosts: telemetry-indexer-logstash
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - telemetry-indexer-logstash

- hosts: broker, coordinator, middlemanager, graphite, overlord, historical
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - druid

- hosts: internal-proxy
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - internal-proxy

- hosts: postgres
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - postgres

# You can use this tag to stop filebeat on the VM temporarily when you dont want to ingest logs for certain period
- hosts: "{{ hosts }}"
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - stop-filebeat

# You can use this tag to start filebeat on the VM in case you have stopped it temporarily
- hosts: "{{ hosts }}"
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - start-filebeat

# You can give your custom host names on jenkins and choose a appropriate tag for your custom hostname
# The filebeat template will be chosen based on the tag
- hosts: "{{ hosts }}"
  become: yes
  gather_facts: no
  vars_files:
    - "{{inventory_dir}}/secrets.yml"
  roles:
    - vm-agents-filebeat
  tags:     
    - "{{ tags }}"
